// Code generated by gtrace. DO NOT EDIT.

package trace

import (
	"context"
)

// Compose returns a new Discovery which has functional fields composed
// both from t and x.
func (t Discovery) Compose(x Discovery) (ret Discovery) {
	switch {
	case t.OnDiscover == nil:
		ret.OnDiscover = x.OnDiscover
	case x.OnDiscover == nil:
		ret.OnDiscover = t.OnDiscover
	default:
		h1 := t.OnDiscover
		h2 := x.OnDiscover
		ret.OnDiscover = func(d DiscoveryDiscoverStartInfo) func(DiscoveryDiscoverDoneInfo) {
			r1 := h1(d)
			r2 := h2(d)
			switch {
			case r1 == nil:
				return r2
			case r2 == nil:
				return r1
			default:
				return func(d DiscoveryDiscoverDoneInfo) {
					r1(d)
					r2(d)
				}
			}
		}
	}
	switch {
	case t.OnWhoAmI == nil:
		ret.OnWhoAmI = x.OnWhoAmI
	case x.OnWhoAmI == nil:
		ret.OnWhoAmI = t.OnWhoAmI
	default:
		h1 := t.OnWhoAmI
		h2 := x.OnWhoAmI
		ret.OnWhoAmI = func(d DiscoveryWhoAmIStartInfo) func(DiscoveryWhoAmIDoneInfo) {
			r1 := h1(d)
			r2 := h2(d)
			switch {
			case r1 == nil:
				return r2
			case r2 == nil:
				return r1
			default:
				return func(d DiscoveryWhoAmIDoneInfo) {
					r1(d)
					r2(d)
				}
			}
		}
	}
	return ret
}
func (t Discovery) onDiscover(d DiscoveryDiscoverStartInfo) func(DiscoveryDiscoverDoneInfo) {
	fn := t.OnDiscover
	if fn == nil {
		return func(DiscoveryDiscoverDoneInfo) {
			return
		}
	}
	res := fn(d)
	if res == nil {
		return func(DiscoveryDiscoverDoneInfo) {
			return
		}
	}
	return res
}
func (t Discovery) onWhoAmI(d DiscoveryWhoAmIStartInfo) func(DiscoveryWhoAmIDoneInfo) {
	fn := t.OnWhoAmI
	if fn == nil {
		return func(DiscoveryWhoAmIDoneInfo) {
			return
		}
	}
	res := fn(d)
	if res == nil {
		return func(DiscoveryWhoAmIDoneInfo) {
			return
		}
	}
	return res
}
func DiscoveryOnDiscover(t Discovery, c *context.Context, address string, database string) func(location string, endpoints []EndpointInfo, _ error) {
	var p DiscoveryDiscoverStartInfo
	p.Context = c
	p.Address = address
	p.Database = database
	res := t.onDiscover(p)
	return func(location string, endpoints []EndpointInfo, e error) {
		var p DiscoveryDiscoverDoneInfo
		p.Location = location
		p.Endpoints = endpoints
		p.Error = e
		res(p)
	}
}
func DiscoveryOnWhoAmI(t Discovery, c *context.Context) func(user string, groups []string, _ error) {
	var p DiscoveryWhoAmIStartInfo
	p.Context = c
	res := t.onWhoAmI(p)
	return func(user string, groups []string, e error) {
		var p DiscoveryWhoAmIDoneInfo
		p.User = user
		p.Groups = groups
		p.Error = e
		res(p)
	}
}
